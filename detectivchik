#include <iostream>
#include <Windows.h>
using namespace std;

void nachalo(int& x, int& y, int& f)
{
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю труп" << endl << "2 - Осмотрю место преступления" << endl << "3 - Опрошу людей, столпившихся вокруг" << endl << "4 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотрев труп, вы понимаете, что это жена мэра. Ее тело все в синяках и порезах, а умерла она от потери крови" << endl;
        cout << "Вероятно, ее убили ножом" << endl; x = 1; break;
    case 2: cout << "Осмотревшись, в мусоре, лежавшем в паре метров от трупа в замечаете окровавленную тряпку, в которой лежит нож." << endl; y = 1; break;
    case 3: cout << "Опросив людей, вы понимаете, что, скорее всего убийцы - семья Демитреску, ведь у них единственных со всего захолустья нет алиби." << endl; f = 1; break;
    case 4: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; x = 0; break;
    }
}

void myasnik(int& x, int& g)
{
    cout << "Вы подошли к дому мясника и опросили его  о случившемся." << endl;
    cout << "В ходе разговора вы замечаете, что он ведет себя подозрительно. Обвините ли вы его в убийстве?" << endl;
    cout << "1 - Да" << endl << "2 - Нет" << endl;
    int z;
    cin >> z;
    if (z == 1)
    {
        cout << "Вы проиграли, ведь обвинили ни в чем не повинного человека.";
        x = 0;
        g = 1;
    }
    else
    {
        cout << "Верный выбор. Мясник ни в чем не виноват.";
    }
}
void nachalo11(int& x, int& y, int& f, int &n)
{
    cout << "Вы уже знаете, что скорее всего человека убили ножом" << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю место преступления" << endl << "2 - Опрошу людей, столпившихся вокруг" << endl << "3 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотревшись, в мусоре, лежавшем в паре метров от трупа в замечаете окровавленную тряпку, в которой лежит нож." << endl; y = 1; break;
    case 2: cout << "Опросив людей, вы понимаете, что, скорее всего убийцы - семья Демитреску, ведь у них единственных со всего захолустья нет алиби." << endl; f = 1; break;
    case 3: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя." << endl; n = 1; break;
    }
}
void nachalo12(int& x, int& y, int& f)
{
    cout << "Вы уже знаете, что скорее всего человека убили ножом" << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю место преступления" << endl << "2 - Опрошу людей, столпившихся вокруг" << endl << "3 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотревшись, в мусоре, лежавшем в паре метров от трупа в замечаете окровавленную тряпку, в которой лежит нож." << endl; y = 1; break;
    case 2: cout << "Опросив людей, вы понимаете, что, скорее всего убийцы - семья Демитреску, ведь у них единственных со всего захолустья нет алиби." << endl; f = 1; break;
    case 3: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя." << endl; break;
    }
}
void yelson(int& x, int& y, int& g)
{
    cout << "В доме Уельсонов вы общаетесь со всей семьей." << endl;
    cout << "В ходе разговора не выясняется ничего подозрительного. Однако ваше чутье говорит вам что тут что-то не так." << endl;
    cout << "Обвините ли вы Роберта в убийстве?" << endl;
    cout << "1 - Да" << endl << "2 - Нет" << endl;
    int z;
    cin >> z;
    if (z == 1)
    {
        cout << "Вы проиграли ведь обвинили ни в чемм неповинного человека. У него даже есть алиби на момент убийства" << endl; x = 0; y = 0; g = 1;
    }
    else
    {
        cout << "Вы молодец, что не поддались своему чутью. Роберт Уельсон не виновен." << endl;
    }
}
void nachalo2(int& x, int& y, int& f)
{
    cout << "Вы уже знаете, что скорее всего человека убили ножом." << endl;
    cout << "Также вы нашли орудие убийства." << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Опрошу людей, столпившихся вокруг" << endl << "2 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Опросив людей, вы понимаете, что, скорее всего убийцы - семья Демитреску, ведь у них единственных со всего захолустья нет алиби." << endl; f = 1; break;
    case 2: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; break;
    }
}
void nachalo21(int& x, int& y, int& f)
{
    cout << "Вы уже осмотрели место преступление и знаете, что скорее всего человека убили ножом." << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю труп" << endl << "2 - Опрошу людей, столпившихся вокруг" << endl << "3 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотрев труп, вы понимаете, что это жена мэра. Ее тело все в синяках и порезах, а умерла она от потери крови" << endl; cout << "Теперь вы знаете, что жертву убили ножом" << endl; x = 1; break;
    case 2: cout << "Опросив людей, вы понимаете, что, скорее всего убийцы - семья Демитреску, ведь у них единственных со всего захолустья нет алиби." << endl; f = 1; break;
    case 3: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; x = 0; break;
    }
}
void nachalo31(int& x, int& y, int& f)
{
    cout << "Предположительно, жертву убили ножом." << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю место преступления" << endl << "2 - Опрошу людей, столпившихся вокруг" << endl << "3 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотревшись, в мусоре, лежавшем в паре метров от трупа в замечаете окровавленную тряпку, в которой лежит нож." << endl; y = 1; break;
    case 2: cout << "Опросив людей, вы ничего нового не узнаете." << endl; f = 1; break;
    case 3: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; x = 0; break;
    }
}
void nachalo32(int& x, int& y, int& f)
{
    cout << "Вы уже осмотрели место преступление и знаете, что скорее всего человека убили ножом." << endl;
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю труп" << endl << "2 - Опрошу людей, столпившихся вокруг" << endl << "3 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотрев труп, вы понимаете, что это жена мэра. Ее тело все в синяках и порезах, а умерла она от потери крови" << endl; cout << "Теперь вы знаете, что жертву убили ножом" << endl; x = 1; break;
    case 2: cout << "Опросив людей, вы ничего нового не узнаете." << endl; f = 1; break;
    case 3: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; x = 0; break;
    }
}
void nachalo33(int& x, int& y, int& f)
{
    cout << "Ваши действия?" << endl;
    cout << "1 - Осмотрю труп" << endl << "2 - Осмотрю место преступления" << endl << "3 - Опрошу людей, столпившихся вокруг" << endl << "4 - Пойду домой" << endl;
    int z;
    cin >> z;
    switch (z)
    {
    case 1: cout << "Осмотрев труп, вы понимаете, что это жена мэра. Ее тело все в синяках и порезах, а умерла она от потери крови" << endl;
        cout << "Вероятно, ее убили ножом" << endl; x = 1; break;
    case 2: cout << "Осмотревшись, в мусоре, лежавшем в паре метров от трупа в замечаете окровавленную тряпку, в которой лежит нож." << endl; y = 1; break;
    case 3: cout << "Опросив людей, вы ничего нового не узнаете." << endl; f = 1; break;
    case 4: cout << "Вы решили пойти домой, однако на полпути вы поняли, что так нельзя и решили вернуться обратно к месту преступления" << endl; x = 0; break;
    }
}
void demitresky()
{
    cout << "Вы пришли к семье Демитреску." << endl;
    cout << "Хоть на первый взгял их семья и кажется доюрожелательной на первый взгляд, но вы безжалостно обвиняете их в убийстве жены мера." << endl;
    cout << "Вы победили! Семья Демитреску, а именно уильям демитреску совершил преступление и сознается в этом." << endl;
    cout << "Теперь он сядет за решетку.";
}
int main()
{
    int x = 0;
    int y = 0;
    int f = 0;
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);
    cout << "Вы - главный шериф этого захолустья." << endl << "Тут произошло жесточайшее убийство, но ни кто даже не подозревает, кто виновник." << endl;
    cout << "Вам предстоит расследовать это дело, но оно явно не будет простым." << endl;
    cout << "Прибыв на место престпуления вы обнаруживаете труп. Мертвое тело лежит за углом около дома мэра этого города." << endl;
a:for (int i = 0;; i++)
{
    if ((x == 0) && (y == 0) && (f == 0))
    {
        nachalo(x, y, f);
        goto a;
    }
    else if ((x == 1) && (y == 0) && (f == 0))
    {
        cout << "В этом городе живет мясник. Учитывая выводы о том что человека убили ножом, можно предположить что убийца и есть мясник" << endl;
        cout << "Пойдете ли вы к нему или останетесь тут?" << endl;
        cout << "1 - Да" << endl << "2 - Нет" << endl;
        int q;
        cin >> q;
        if (q == 1)
        {
            int g = 0;
            myasnik(x, g);
            m: if (g == 1)
            {
                break;
            }
            else if (g==0)
            {
                int n = 0;
                cout << "Вам остается только вернуться на место преступления." << endl;
                nachalo11(x, y, f,n);
                if (n==1) goto m;
                goto a;
            }
        }
        else
        {
            nachalo12(x, y, f);
            goto a;
        }
    }
    else if (((y == 1) && (x == 1) && (f == 0)) || ((y == 1) && (x == 0) && (f == 0)))
    {
        int g = 0;
        cout << "Такие ножи есть только в домах двух семей. Одни - доброжелательные граждане, которых любит весь город." << endl;
        cout << "О другой семье известно лишь то что их глава семьи - Роберт Уельсон раньше сидел в тюрьме по убиству." << endl;
        cout << "Вы идете к семье Ульсонов." << endl;
        yelson(x, y, g);
        if (g == 1) break;
        k: if ((x == 0) && (f==0))
        {
            nachalo21(x, y, f);
            goto k;
        }
        else if ((x==1) && (f==0))
        {
            nachalo2(x, y, f);
            goto a;
        }
        goto a;
    }
    else if (f == 1)
    {
    b:if ((x == 0) || (y == 0))
    {
        cout << "К сожалению, на данный момент у вас недостаточно доказательств. Поищите что нибудь еще.";
        if ((x == 1) && (y == 0))
        {
            nachalo31(x, y, f);
        }
        else if ((y == 1) && (x == 0))
        {
            nachalo32(x, y, f);
        }
        else if ((x == 0) && (y == 0))
        {
            nachalo33(x, y, f);
        }
        goto b;
    }
    else if ((x == 1) && (y == 1))
    {
        demitresky();
    }
    }
    break;
}
return 0;
}
